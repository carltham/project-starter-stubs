<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Node + TypeScript + MySQL REST API — Playground</title>
  <style>
    :root {
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color-scheme: light;
    }

    body {
      margin: 0;
      padding: 24px;
      background: #f7f8fb;
      color: #111;
    }

    header {
      margin-bottom: 18px;
    }

    h1 {
      margin: 0 0 6px 0;
      font-size: 20px;
    }

    p.lead {
      margin: 0 0 12px 0;
      color: #444;
      font-size: 13px;
    }

    .card {
      background: #fff;
      border-radius: 8px;
      padding: 16px;
      box-shadow: 0 1px 0 rgba(16, 24, 40, 0.04);
      max-width: 900px;
    }

    .row {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items: center;
      margin-bottom: 12px;
    }

    label {
      font-size: 12px;
      color: #333;
      display: block;
      margin-bottom: 6px;
    }

    input[type="text"],
    select,
    textarea {
      font: 13px/1.3 sans-serif;
      padding: 8px;
      border: 1px solid #e6e9ef;
      border-radius: 6px;
      background: #fff;
    }

    input[type="text"] {
      min-width: 260px;
    }

    select {
      min-width: 120px;
    }

    textarea {
      width: 100%;
      min-height: 120px;
      resize: vertical;
    }

    button {
      padding: 8px 12px;
      border-radius: 6px;
      border: none;
      background: #0366d6;
      color: white;
      cursor: pointer;
      font-weight: 600;
    }

    button:disabled {
      opacity: 0.6;
      cursor: default;
    }

    pre {
      background: #0b1220;
      color: #d6e8ff;
      padding: 12px;
      border-radius: 6px;
      overflow: auto;
      max-height: 360px;
    }

    .meta {
      font-size: 12px;
      color: #666;
      margin-top: 10px;
    }

    .flex-1 {
      flex: 1 1 0;
    }
  </style>
</head>

<body>
  <header>
    <h1>REST API Playground</h1>
    <p class="lead">Quick UI to test your local Node + TypeScript + MySQL REST API. Set the base URL, pick method and
      path, send JSON bodies and inspect responses.</p>
  </header>

  <main class="card" role="main">
    <div class="row">
      <div>
        <label for="baseUrl">Base URL</label>
        <input id="baseUrl" type="text" value="http://localhost:3000" />
      </div>

      <div>
        <label for="method">Method</label>
        <select id="method">
          <option>GET</option>
          <option>POST</option>
          <option>PUT</option>
          <option>PATCH</option>
          <option>DELETE</option>
        </select>
      </div>

      <div class="flex-1">
        <label for="path">Path (e.g. /users or /users/1)</label>
        <input id="path" type="text" value="/users" />
      </div>
    </div>

    <div>
      <label for="body">Request body (JSON) — only used with POST/PUT/PATCH</label>
      <textarea id="body" placeholder='{"name":"Alice","email":"alice@example.com"}'></textarea>
    </div>

    <div style="margin-top:12px; display:flex; gap:8px; align-items:center;">
      <button id="send">Send</button>
      <button id="pretty" type="button">Toggle Pretty JSON</button>
      <div class="meta" id="status">Ready</div>
    </div>

    <section style="margin-top:16px;">
      <label>Response</label>
      <pre id="response">No request made yet.</pre>
    </section>
  </main>

  <script>
    ( function() {
      const baseUrlEl = document.getElementById( 'baseUrl' );
      const methodEl = document.getElementById( 'method' );
      const pathEl = document.getElementById( 'path' );
      const bodyEl = document.getElementById( 'body' );
      const sendBtn = document.getElementById( 'send' );
      const responseEl = document.getElementById( 'response' );
      const statusEl = document.getElementById( 'status' );
      const prettyBtn = document.getElementById( 'pretty' );

      let pretty = true;

      function setStatus( text,error ) {
        statusEl.textContent = text;
        statusEl.style.color = error ? '#a33' : '#666';
      }

      function safeJsonParse( text ) {
        try { return JSON.parse( text ); } catch ( e ) { return null; }
      }

      prettyBtn.addEventListener( 'click',() => {
        pretty = !pretty;
        prettyBtn.textContent = pretty ? 'Toggle Pretty JSON' : 'Toggle Raw';
      } );

      sendBtn.addEventListener( 'click',async () => {
        const base = baseUrlEl.value.trim() || location.origin;
        let path = pathEl.value.trim() || '/';
        if ( !path.startsWith( '/' ) ) path = '/' + path;
        const url = base.replace( /\/+$/,'' ) + path;
        const method = methodEl.value;
        let body = bodyEl.value.trim();
        let init = { method,headers: {} };

        if ( method === 'GET' || method === 'DELETE' ) {
          // no body
        } else {
          if ( body ) {
            const parsed = safeJsonParse( body );
            if ( parsed === null ) {
              setStatus( 'Invalid JSON body',true );
              return;
            }
            init.headers['Content-Type'] = 'application/json';
            init.body = JSON.stringify( parsed );
          } else {
            init.headers['Content-Type'] = 'application/json';
            init.body = JSON.stringify( {} );
          }
        }

        setStatus( 'Sending ...' );
        responseEl.textContent = '';

        try {
          const res = await fetch( url,init );
          const text = await res.text();
          let output = {
            status: res.status,
            ok: res.ok,
            headers: {},
            body: text
          };
          res.headers.forEach( ( v,k ) => ( output.headers[k] = v ) );

          // try parse body as JSON for nicer display
          const json = safeJsonParse( text );
          if ( json !== null ) output.body = json;

          const display = pretty
            ? JSON.stringify( output,null,2 )
            : String( output.body );

          responseEl.textContent = display;
          setStatus( 'HTTP ' + res.status + ( res.ok ? ' OK' : ' Error' ),!res.ok );
        } catch ( err ) {
          responseEl.textContent = String( err );
          setStatus( 'Network error',true );
        }
      } );

      // quick keyboard shortcuts
      document.addEventListener( 'keydown',( e ) => {
        if ( ( e.ctrlKey || e.metaKey ) && e.key === 'Enter' ) {
          e.preventDefault();
          sendBtn.click();
        }
      } );
    } )();
  </script>
</body>

</html>